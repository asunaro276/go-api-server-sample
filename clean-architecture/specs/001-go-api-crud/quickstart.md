# ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆã‚¬ã‚¤ãƒ‰: Go API ã‚µãƒ¼ãƒãƒ¼

**å¯¾è±¡**: é–‹ç™ºè€…å‘ã‘ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã¨APIãƒ†ã‚¹ãƒˆæ‰‹é †
**å‰ææ¡ä»¶**: Go 1.24+ã€Dockerã€PostgreSQL

## ğŸ“‹ å‰ææ¡ä»¶

### å¿…è¦ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢
- **Go**: ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 1.24 ä»¥ä¸Š
- **Docker & Docker Compose**: PostgreSQL ã‚³ãƒ³ãƒ†ãƒŠå®Ÿè¡Œç”¨
- **curl ã¾ãŸã¯ Postman**: API ãƒ†ã‚¹ãƒˆç”¨
- **make**: ãƒ“ãƒ«ãƒ‰ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œç”¨

### ç¢ºèªã‚³ãƒãƒ³ãƒ‰
```bash
go version    # Go 1.24+ ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª
docker --version
docker compose version
make --version
```

## ğŸš€ ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### 1. ãƒªãƒã‚¸ãƒˆãƒªè¨­å®š
```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«ç§»å‹•
cd go-api-server-sample

# ä¾å­˜é–¢ä¿‚ã®ç¢ºèª
go mod tidy
```

### 2. ç’°å¢ƒãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
```bash
# .env ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼ˆã‚µãƒ³ãƒ—ãƒ«ã‚’ã‚³ãƒ”ãƒ¼ï¼‰
cp .env.example .env

# ç’°å¢ƒå¤‰æ•°ã®å†…å®¹ç¢ºèªãƒ»ç·¨é›†
cat .env
```

**æ¨å¥¨ç’°å¢ƒå¤‰æ•°**:
```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­å®š
DB_HOST=localhost
DB_PORT=5432
DB_USER=api_user
DB_PASSWORD=api_password
DB_NAME=api_db

# ã‚µãƒ¼ãƒãƒ¼è¨­å®š
PORT=8080
GIN_MODE=debug

# ãƒ­ã‚°è¨­å®š
LOG_LEVEL=debug
```

### 3. PostgreSQL ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
```bash
# PostgreSQL ã‚³ãƒ³ãƒ†ãƒŠèµ·å‹•
make docker-up

# ã‚³ãƒ³ãƒ†ãƒŠèµ·å‹•ç¢ºèª
docker ps | grep postgres

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãƒ†ã‚¹ãƒˆ
make db-ping
```

### 4. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–
```bash
# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
make migrate

# åˆæœŸãƒ‡ãƒ¼ã‚¿æŠ•å…¥ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
make seed

# ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆç¢ºèª
make db-status
```

## ğŸƒâ€â™‚ï¸ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹•

### é–‹ç™ºãƒ¢ãƒ¼ãƒ‰ï¼ˆãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰ï¼‰
```bash
# air ã‚’ä½¿ã£ãŸè‡ªå‹•ãƒªãƒ­ãƒ¼ãƒ‰èµ·å‹•
make dev

# ã¾ãŸã¯ç›´æ¥å®Ÿè¡Œ
air
```

### é€šå¸¸å®Ÿè¡Œ
```bash
# ãƒ“ãƒ«ãƒ‰ã—ã¦å®Ÿè¡Œ
make run

# ã¾ãŸã¯æ‰‹å‹•ãƒ“ãƒ«ãƒ‰
make build
./bin/api-server
```

### èµ·å‹•ç¢ºèª
```bash
# ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
curl http://localhost:8080/health

# æœŸå¾…ãƒ¬ã‚¹ãƒãƒ³ã‚¹
{
  "status": "healthy",
  "database": "connected",
  "timestamp": "2025-09-28T15:30:00Z"
}
```

## ğŸ§ª API ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª

### 1. ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
```bash
curl -X GET http://localhost:8080/health
```

**æœŸå¾…çµæœ**: 200 OK, ã‚·ã‚¹ãƒ†ãƒ å¥å…¨æ€§æƒ…å ±

### 2. ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä½œæˆ
```bash
curl -X POST http://localhost:8080/api/v1/contents \
  -H "Content-Type: application/json" \
  -d '{
    "title": "ãƒ†ã‚¹ãƒˆè¨˜äº‹",
    "body": "ã“ã‚Œã¯ãƒ†ã‚¹ãƒˆç”¨ã®è¨˜äº‹ã§ã™ã€‚",
    "content_type": "article",
    "author": "ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼"
  }'
```

**æœŸå¾…çµæœ**: 201 Created, ä½œæˆã•ã‚ŒãŸã‚³ãƒ³ãƒ†ãƒ³ãƒ„æƒ…å ±ï¼ˆIDã‚’å«ã‚€ï¼‰

### 3. ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä¸€è¦§å–å¾—
```bash
curl -X GET http://localhost:8080/api/v1/contents
```

**æœŸå¾…çµæœ**: 200 OK, ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä¸€è¦§ï¼ˆä½œæˆã—ãŸã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å«ã‚€ï¼‰

### 4. ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è©³ç´°å–å¾—
```bash
# ID=1 ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å–å¾—
curl -X GET http://localhost:8080/api/v1/contents/1
```

**æœŸå¾…çµæœ**: 200 OK, æŒ‡å®šIDã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è©³ç´°

### 5. ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æ›´æ–°
```bash
curl -X PUT http://localhost:8080/api/v1/contents/1 \
  -H "Content-Type: application/json" \
  -d '{
    "title": "æ›´æ–°ã•ã‚ŒãŸãƒ†ã‚¹ãƒˆè¨˜äº‹",
    "body": "ã“ã‚Œã¯æ›´æ–°ã•ã‚ŒãŸãƒ†ã‚¹ãƒˆç”¨ã®è¨˜äº‹ã§ã™ã€‚",
    "content_type": "blog",
    "author": "æ›´æ–°è€…"
  }'
```

**æœŸå¾…çµæœ**: 200 OK, æ›´æ–°ã•ã‚ŒãŸã‚³ãƒ³ãƒ†ãƒ³ãƒ„æƒ…å ±

### 6. ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å‰Šé™¤
```bash
curl -X DELETE http://localhost:8080/api/v1/contents/1
```

**æœŸå¾…çµæœ**: 204 No Content

### 7. å‰Šé™¤ç¢ºèª
```bash
curl -X GET http://localhost:8080/api/v1/contents/1
```

**æœŸå¾…çµæœ**: 404 Not Found

## ğŸ” ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãƒ»ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ ãƒ†ã‚¹ãƒˆ

### ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¿ã‚¤ãƒ—ãƒ•ã‚£ãƒ«ã‚¿
```bash
curl -X GET "http://localhost:8080/api/v1/contents?content_type=article"
```

### ä½œæˆè€…ãƒ•ã‚£ãƒ«ã‚¿
```bash
curl -X GET "http://localhost:8080/api/v1/contents?author=ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼"
```

### ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³
```bash
# æœ€åˆã®5ä»¶ã‚’å–å¾—
curl -X GET "http://localhost:8080/api/v1/contents?limit=5&offset=0"

# æ¬¡ã®5ä»¶ã‚’å–å¾—
curl -X GET "http://localhost:8080/api/v1/contents?limit=5&offset=5"
```

## ğŸ›  é–‹ç™ºãƒ„ãƒ¼ãƒ«

### ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
```bash
# å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
make test

# ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ããƒ†ã‚¹ãƒˆ
make test-coverage

# çµ±åˆãƒ†ã‚¹ãƒˆ
make test-integration

# ç‰¹å®šãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒ†ã‚¹ãƒˆ
go test -v ./internal/domain/entities
```

### ã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯
```bash
# ãƒªãƒ³ãƒˆå®Ÿè¡Œ
make lint

# ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
make fmt

# å‹ãƒã‚§ãƒƒã‚¯
make vet

# å…¨ãƒã‚§ãƒƒã‚¯
make check
```

### ãƒ¢ãƒƒã‚¯ç”Ÿæˆ
```bash
# ãƒ¢ãƒƒã‚¯ç”Ÿæˆ
make mock-gen

# ç”Ÿæˆã•ã‚ŒãŸãƒ¢ãƒƒã‚¯ã®ç¢ºèª
ls internal/testing/mocks/
```

## ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ

### åŸºæœ¬è² è·ãƒ†ã‚¹ãƒˆ
```bash
# ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
ab -n 1000 -c 10 http://localhost:8080/health

# ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä¸€è¦§å–å¾—
ab -n 1000 -c 10 http://localhost:8080/api/v1/contents
```

**æœŸå¾…å€¤**: ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ < 200ms p95

### ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆ
```bash
make test-performance
```

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

#### 1. PostgreSQL æ¥ç¶šã‚¨ãƒ©ãƒ¼
```bash
# ã‚¨ãƒ©ãƒ¼ä¾‹: connection refused
# è§£æ±º: PostgreSQL ã‚³ãƒ³ãƒ†ãƒŠã®çŠ¶æ…‹ç¢ºèª
docker ps
make docker-up

# ãƒãƒ¼ãƒˆç«¶åˆã®å ´åˆ
docker port postgres_container
```

#### 2. ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼
```bash
# ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆå¤±æ•—
# è§£æ±º: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒªã‚»ãƒƒãƒˆ
make migrate-reset
make migrate
```

#### 3. ãƒãƒ¼ãƒˆç«¶åˆ
```bash
# ãƒãƒ¼ãƒˆ 8080 ãŒä½¿ç”¨ä¸­
# è§£æ±º: ãƒãƒ¼ãƒˆç¢ºèªã¨å¤‰æ›´
lsof -i :8080
export PORT=8081
make run
```

#### 4. ä¾å­˜é–¢ä¿‚ã‚¨ãƒ©ãƒ¼
```bash
# ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è§£æ±ºã‚¨ãƒ©ãƒ¼
# è§£æ±º: ä¾å­˜é–¢ä¿‚ã®å†å–å¾—
go clean -modcache
go mod download
go mod tidy
```

#### 5. ãƒ†ã‚¹ãƒˆå¤±æ•—
```bash
# testcontainers ã‚¨ãƒ©ãƒ¼
# è§£æ±º: Docker ãƒ‡ãƒ¼ãƒ¢ãƒ³ç¢ºèª
systemctl status docker
docker info
```

## ğŸ“ ãƒ­ã‚°ç¢ºèª

### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚°
```bash
# é–‹ç™ºãƒ¢ãƒ¼ãƒ‰ã§ã®ãƒ­ã‚°ç›£è¦–
tail -f logs/app.log

# ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ­ã‚°ï¼ˆJSONå½¢å¼ï¼‰
make dev | jq '.'
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ­ã‚°
```bash
# PostgreSQL ã‚³ãƒ³ãƒ†ãƒŠãƒ­ã‚°
docker logs postgres_container -f
```

## ğŸ”§ é–‹ç™ºè¨­å®š

### VSCode è¨­å®šæ¨å¥¨
```json
{
  "go.formatTool": "goimports",
  "go.lintTool": "golangci-lint",
  "go.testFlags": ["-v"],
  "go.coverOnSave": true
}
```

### ãƒ‡ãƒãƒƒã‚°è¨­å®š
```json
{
  "type": "go",
  "request": "launch",
  "mode": "debug",
  "program": "./cmd/api-server",
  "env": {
    "GIN_MODE": "debug"
  }
}
```

## âœ… ç’°å¢ƒæº–å‚™å®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] Go 1.24+ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†
- [ ] Docker & Docker Compose èµ·å‹•ç¢ºèª
- [ ] PostgreSQL ã‚³ãƒ³ãƒ†ãƒŠèµ·å‹•å®Œäº†
- [ ] ç’°å¢ƒå¤‰æ•°è¨­å®šå®Œäº†
- [ ] ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œå®Œäº†
- [ ] ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹•æˆåŠŸ
- [ ] ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ API å¿œç­”ç¢ºèª
- [ ] CRUD API åŸºæœ¬å‹•ä½œç¢ºèª
- [ ] ãƒ†ã‚¹ãƒˆå®Ÿè¡ŒæˆåŠŸ
- [ ] ãƒªãƒ³ãƒˆãƒ»ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆç¢ºèª

## ğŸ“š æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. **å®Ÿè£…ãƒ•ã‚§ãƒ¼ã‚º**: `/tasks` ã‚³ãƒãƒ³ãƒ‰ã§ã‚¿ã‚¹ã‚¯ä¸€è¦§ç”Ÿæˆ
2. **TDD ã‚µã‚¤ã‚¯ãƒ«**: Red-Green-Refactor ã®å®Ÿè·µ
3. **CI/CD è¨­å®š**: GitHub Actions ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ§‹ç¯‰
4. **ç›£è¦–è¨­å®š**: ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãƒ»ãƒ­ã‚°ç›£è¦–ã®å°å…¥

## ğŸ’¡ é–‹ç™ºã®ãƒ’ãƒ³ãƒˆ

- **ã‚³ãƒŸãƒƒãƒˆå‰ã«å¿…ãš `make check` ã‚’å®Ÿè¡Œ**
- **Clean Architecture åŸå‰‡ã‚’æ„è­˜ã—ãŸå®Ÿè£…**
- **ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®å®Ÿè·µ**
- **é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®å®Ÿè£…**
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã®éµå®ˆ**