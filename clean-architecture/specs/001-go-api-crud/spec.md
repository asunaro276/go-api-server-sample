# 機能仕様書: Go APIサーバー（ヘルスチェック・CRUD）

**機能ブランチ**: `001-go-api-crud`
**作成日**: 2025-09-28
**ステータス**: ドラフト
**入力**: ユーザー説明: "簡単なgoのAPIサーバーを作ってください、エンドポイントとしてはヘルスチェックとCRUDを持ちます。"
**明確化**: CRUD機能を持つ簡単なCMSを作成。認証認可は無し、データベースはPostgreSQL、レスポンス形式はJSON。

## 実行フロー (main)
```
1. 入力からユーザー説明を解析
   → 空の場合: ERROR "機能説明が提供されていません"
2. 説明から主要概念を抽出
   → 特定項目: アクター、アクション、データ、制約
3. 不明確な側面ごとの対応内容:
   → [要明確化: CRUDの対象エンティティが特定されていません]
   → [要明確化: 認証・認可要件が明確でありません]
   → [要明確化: データベースの種類とスキーマが不明です]
4. ユーザーシナリオ & テストセクションを記入
   → 明確なユーザーフローがない場合: ERROR "ユーザーシナリオを決定できません"
5. 機能要件を生成
   → 各要件はテスト可能でなければならない
   → 曖昧な要件をマーク
6. 主要エンティティを特定（データが関わる場合）
7. レビューチェックリストを実行
   → [要明確化]がある場合: WARN "仕様に不確実性があります"
   → 実装詳細が見つかった場合: ERROR "技術詳細を削除してください"
8. 返却: SUCCESS (仕様書は計画段階準備完了)
```

---

## ⚡ クイックガイドライン
- ✅ ユーザーが何を必要とし、なぜ必要なのかに焦点を当てる
- ❌ 実装方法は避ける（技術スタック、API、コード構造なし）
- 👥 開発者ではなく、ビジネス関係者向けに記述

### セクション要件
- **必須セクション**: すべての機能で完了する必要がある
- **オプションセクション**: 機能に関連する場合のみ含める
- セクションが適用されない場合は、完全に削除する（"N/A"として残さない）

### AI生成の場合
ユーザープロンプトからこの仕様書を作成する際:
1. **すべての曖昧さをマーク**: 仮定が必要な箇所には[要明確化: 具体的な質問]を使用
2. **推測しない**: プロンプトで特定されていない内容（例：認証方法なしの「ログインシステム」）はマークする
3. **テスターのように考える**: 曖昧な要件は「テスト可能で曖昧でない」チェックリスト項目に失敗するはず
4. **一般的に不十分に指定される領域**:
   - ユーザータイプと権限
   - データ保持/削除ポリシー
   - パフォーマンス目標と規模
   - エラーハンドリングの動作
   - 統合要件
   - セキュリティ/コンプライアンス要件

---

## ユーザーシナリオ & テスト *(必須)*

### 主要ユーザーストーリー
コンテンツ管理者として、Webサイトやアプリケーションのコンテンツを効率的に作成・編集・削除できるAPIシステムが必要です。これにより、様々なタイプのコンテンツ（ページ、記事、商品情報、ニュースなど）を動的に管理し、フロントエンドアプリケーションがそのデータを取得して表示できるようになります。

### 受け入れシナリオ
1. **前提条件** サーバーが稼働している, **操作** ヘルスチェックエンドポイントにアクセス, **期待結果** サーバーの稼働状況が確認できる
2. **前提条件** 新しいコンテンツを作成したい, **操作** POST リクエストでタイトル・本文・メタデータを送信, **期待結果** コンテンツが正常に作成され、一意のIDが返される
3. **前提条件** 既存のコンテンツIDを知っている, **操作** GET リクエストで特定コンテンツを取得, **期待結果** 指定したコンテンツの詳細情報が返される
4. **前提条件** すべてのコンテンツ一覧を確認したい, **操作** GET リクエストでコンテンツ一覧を取得, **期待結果** 公開されている全コンテンツのリストが返される
5. **前提条件** 既存コンテンツを修正したい, **操作** PUT リクエストでコンテンツ内容を更新, **期待結果** コンテンツが正常に更新される
6. **前提条件** 不要になったコンテンツを削除したい, **操作** DELETE リクエストでコンテンツを削除, **期待結果** コンテンツが正常に削除される

### エッジケース
- 存在しないコンテンツIDでアクセスした場合、404エラーが適切に返される
- 必須フィールドが欠けているリクエストの場合、400エラーとバリデーションメッセージが返される
- データベース接続エラーの場合、ヘルスチェックが異常ステータスを返す
- 大量のコンテンツ取得要求の場合、適切にページネーションされる

## 要件 *(必須)*

### 機能要件
- **FR-001**: システムはヘルスチェック機能を提供し、サーバーとデータベースの稼働状況を確認できなければならない
- **FR-002**: システムは新しいコンテンツの作成機能を提供しなければならない
- **FR-003**: システムは特定IDによるコンテンツの取得機能を提供しなければならない
- **FR-004**: システムは全コンテンツの一覧取得機能を提供しなければならない
- **FR-005**: システムは既存コンテンツの更新機能を提供しなければならない
- **FR-006**: システムはコンテンツの削除機能を提供しなければならない
- **FR-007**: システムはPostgreSQLデータベースにデータを永続化しなければならない
- **FR-008**: システムは不正なリクエストに対して適切なHTTPステータスコードとエラーメッセージを返さなければならない
- **FR-009**: システムはJSON形式でレスポンスを返さなければならない
- **FR-010**: システムは入力データの基本的なバリデーション（必須フィールド、データ型）を実行しなければならない
- **FR-011**: システムは認証・認可機能なしでリクエストを処理しなければならない

### 主要エンティティ *(機能がデータを扱う場合に含める)*
- **コンテンツアイテム**: コンテンツの基本単位で、タイトル、本文、コンテンツタイプ、作成者、作成日時、更新日時を含む。様々なコンテンツタイプ（ページ、記事、商品情報、ニュースなど）に対応できる汎用的な構造

---

## レビュー & 受け入れチェックリスト
*ゲート: main()実行中に実行される自動チェック*

### コンテンツ品質
- [x] 実装詳細なし（言語、フレームワーク、API）
- [x] ユーザー価値とビジネスニーズに焦点
- [x] 非技術関係者向けに記述
- [x] すべての必須セクションが完了

### 要件完全性
- [x] [要明確化]マーカーが残っていない
- [x] 要件がテスト可能で曖昧でない
- [x] 成功基準が測定可能
- [x] スコープが明確に境界づけられている
- [x] 依存関係と前提条件が特定されている

---

## 実行ステータス
*処理中にmain()によって更新*

- [x] ユーザー説明解析完了
- [x] 主要概念抽出完了
- [x] 曖昧さマーク完了
- [x] ユーザーシナリオ定義完了
- [x] 要件生成完了
- [x] エンティティ特定完了
- [x] レビューチェックリスト通過完了

---